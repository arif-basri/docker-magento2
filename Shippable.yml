language: php

php:
  - 7.1

build:
  pre_ci_boot:
    options: "-v /app:/app"
  ci:
    - cp -R . /app
    - pip install -U docker-compose
    - docker-compose up -d
    - sleep 10
    - docker exec docker-magento2_web_1 install-magento
    - docker exec docker-magento2_web_1 install-sampledata

before_script:
  - mkdir -p shippable/codecoverage
  - mkdir -p shippable/testresults
  
script:
 - docker exec magento2_web_1 /var/www/html/vendor/bin/phpunit -c dev/tests/unit/phpunit.xml.dist
 - docker-compose down
 
notifications:
  email: false
